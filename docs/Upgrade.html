<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upgrade guide | Bolero: F# in WebAssembly</title>
  <link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32" />
  <meta id='websharper-data' name='websharper-data' content='{"$TYPES":[],"$DATA":{"$V":{}}}' />

  <link rel="stylesheet" href="/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js" type="text/javascript" charset="UTF-8"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/fsharp.min.js" type="text/javascript" charset="UTF-8"></script><link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/vs.min.css"></link>

</head>
<body>
  <header class="navbar ">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-hoverable" onclick="Website.Client.ToggleDrawer()"><i class="fa fa-bars"></i></a>
        <span class="navbar-item"><a href="/">Bolero</a></span>
      </div>
      <div class="navbar-menu">
        <nav class="navbar-start"><a href="/" class="navbar-item is-hoverable has-text-weight-bold">Home</a><div class="navbar-item is-hoverable has-text-weight-bold has-dropdown">
            <a href="/docs" class="navbar-link is-arrowless">Documentation</a>
            <div class="navbar-dropdown has-text-weight-normal"><a class="navbar-item" href="/docs">Getting Started</a><a class="navbar-item" href="/docs/HTML">Writing HTML</a><a class="navbar-item" href="/docs/Templating">HTML templates</a><a class="navbar-item" href="/docs/Elmish">Using Elmish</a><a class="navbar-item" href="/docs/Routing">Routing</a><a class="navbar-item" href="/docs/Remoting">Remoting</a><a class="navbar-item" href="/docs/Blazor">Using Blazor features</a><a class="navbar-item" href="/docs/Upgrade">Upgrade guide</a></div>
          </div><a href="https://tryfsharp.fsbolero.io" class="navbar-item is-hoverable has-text-weight-bold">Try F#</a></nav>
        <nav class="navbar-end">
          <a target="_blank" title="GitHub" href="https://github.com/fsbolero/bolero" class="navbar-item is-hoverable"><i class="fa fa-github"></i></a>
          <a target="_blank" title="Twitter" href="https://twitter.com/fsbolero" class="navbar-item is-hoverable"><i class="fa fa-twitter"></i></a>
        </nav>
      </div>
    </div>
  </header>
  <div class="drawer-backdrop" onclick="Website.Client.ToggleDrawer()">
    <div id="left-drawer" class="lhs-drawer">
      <nav class="menu">
        <ul class="menu-list"><li>
            <a href="/">Home</a>
            
          </li><li>
            <a href="/docs">Documentation</a>
            <ul><li>
            <a href="/docs">Getting Started</a>
            
          </li><li>
            <a href="/docs/HTML">Writing HTML</a>
            
          </li><li>
            <a href="/docs/Templating">HTML templates</a>
            
          </li><li>
            <a href="/docs/Elmish">Using Elmish</a>
            
          </li><li>
            <a href="/docs/Routing">Routing</a>
            
          </li><li>
            <a href="/docs/Remoting">Remoting</a>
            
          </li><li>
            <a href="/docs/Blazor">Using Blazor features</a>
            
          </li><li>
            <a href="/docs/Upgrade">Upgrade guide</a>
            
          </li></ul>
          </li><li>
            <a href="https://tryfsharp.fsbolero.io">Try F#</a>
            
          </li></ul>
      </nav>
    </div>
  </div>
  
      <section class="with-sidebar-background">
        <div class="container">
          <div class="columns is-gapless">
            <div class="column content markdown-column">
              <section class="hero">
                <div class="hero-body">
                  <h1 class="title">Upgrade guide</h1>
                  <p class="subtitle">
How to update a project for newer releases</p>

                </div>
              </section>
              <section class="section"><div ws-preserve=""><h3 id="from-v0.7-to-v0.8">From v0.7 to v0.8</h3>
<p>Bolero 0.8 upgrades the dependency on Blazor and .NET Core to 3.0-preview8. Here are the associated upgrade steps:</p>
<ul>
<li><p>Install <a href="https://dotnet.microsoft.com/download/dotnet-core">.NET Core 3.0-preview8</a>.</p>
</li>
<li><p>The server-side module <code>Remote</code> has been removed, with its functions <code>withHttpContext</code>, <code>authorize</code> and <code>authorizeWith</code>.</p>
<p>Instead, a new type <code>IRemoteContext</code> is provided via dependency injection:</p>
<pre><code class="language-fsharp">type IRemoteContext =
    inherit IHttpContextAccessor // member HttpContext : HttpContext with get, set
    member Authorize : ('req -&gt; Async&lt;'resp&gt;) -&gt; ('req -&gt; Async&lt;'resp&gt;)
    member AuthorizeWith : seq&lt;IAuthorizeData&gt; -&gt; ('req -&gt; Async&lt;'resp&gt;) -&gt; ('req -&gt; Async&lt;'resp&gt;)
</code></pre>
<p>To obtain this new value:</p>
<ul>
<li><p>If you use a <code>RemoteHandler</code> class with dependency injection, simply take <code>ctx: IRemoteContext</code> as additional argument in its constructor.</p>
</li>
<li><p>If you use a plain record value, make it instead a function that takes <code>ctx: IRemoteContext</code> as argument and returns the record.
New overloads on <code>IServiceCollection.AddRemoting</code> can take such a function as argument.</p>
</li>
</ul>
<p>Then, to use it:</p>
<ul>
<li><p>Replace <code>Remote.withContext &lt;| fun http arg -&gt; // ...</code> with a simple <code>fun arg -&gt; ...</code>.</p>
</li>
<li><p>Replace <code>Remote.authorize &lt;| fun http arg -&gt; // ...</code> with <code>ctx.Authorize &lt;| fun arg -&gt; ...</code>.</p>
</li>
<li><p>Replace <code>Remote.authorizeWith attrs &lt;| fun http arg -&gt; // ...</code> with <code>ctx.AuthorizeWith attrs &lt;| fun arg -&gt; ...</code>.</p>
</li>
</ul>
<p>In all three cases, use <code>ctx.HttpContext</code> instead of <code>http</code> in the function.</p>
</li>
</ul>
<h3 id="from-v0.6-to-v0.7">From v0.6 to v0.7</h3>
<p>Bolero 0.7 updates the dependency on Blazor and .NET Core to 3.0-preview7. Here are the associated upgrade steps:</p>
<ul>
<li><p>Install <a href="https://dotnet.microsoft.com/download/dotnet-core">.NET Core 3.0-preview7</a>.</p>
</li>
<li><p><code>Cmd.ofRemote</code>, <code>Cmd.performRemote</code> and the related type <code>RemoteResponse&lt;'T&gt;</code> are obsolete. Here is how to update:</p>
<ul>
<li><p>If the remote call is to a non-authorized function, then simply use <code>Cmd.ofAsync</code> / <code>Cmd.performAsync</code>.</p>
</li>
<li><p>If the remote call is to an authorized function, then replace <code>RemoteResponse&lt;'T&gt;</code> with <code>option&lt;'T&gt;</code>, <code>Cmd.ofRemote</code> with <code>Cmd.ofAuthorized</code> and <code>Cmd.performRemote</code> with <code>Cmd.performAuthorized</code>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="from-v0.5-to-v0.6">From v0.5 to v0.6</h3>
<p>Bolero 0.6 updates the dependency on Blazor and .NET Core to 3.0-preview6. Here are the associated upgrade steps:</p>
<ul>
<li><p>Install <a href="https://dotnet.microsoft.com/download/dotnet-core">.NET Core 3.0-preview6</a>.</p>
</li>
<li><p>The server-side <code>Startup.fs</code> code has changed. In <code>Configure</code>, the method <code>UseBlazor</code> has been removed; replace it with the following:</p>
<pre><code class="language-fsharp">    .UseClientSideBlazorFiles&lt;Client.Startup&gt;()
    .UseRouting()
    .UseEndpoints(fun endpoints -&gt;
        endpoints.MapDefaultControllerRoute() |&gt; ignore
        endpoints.MapFallbackToClientSideBlazor&lt;Client.Startup&gt;(&quot;index.html&quot;) |&gt; ignore)
</code></pre>
<p>This requires the addition of the following line in <code>ConfigureServices</code>:</p>
<pre><code class="language-fsharp">    services.AddMvcCore() |&gt; ignore
</code></pre>
</li>
</ul>
<p>HTML hot reloading also received changes.</p>
<ul>
<li><p>A new NuGet package <code>Bolero.HotReload.Server</code> needs to be referenced by the <code>Server</code> project.</p>
</li>
<li><p><code>IAppBuilder.UseHotReload</code> is deprecated; instead, add <code>endpoints.UseHotReload()</code> at the top of the <code>UseEndPoints</code> callback:</p>
<pre><code class="language-fsharp">    .UseClientSideBlazorFiles&lt;Client.Startup&gt;()
    .UseRouting()
    .UseEndpoints(fun endpoints -&gt;
        endpoints.UseHotReload()
        endpoints.MapDefaultControllerRoute() |&gt; ignore
        endpoints.MapFallbackToClientSideBlazor&lt;Client.Startup&gt;(&quot;index.html&quot;) |&gt; ignore)
</code></pre>
</li>
</ul>
<h3 id="from-v0.4-to-v0.5">From v0.4 to v0.5</h3>
<p><img src="../img/blazor-icon.png" alt="Blazor 3.0" /></p>
<p>Bolero 0.5 doesn't bring any breaking API changes.
However, it upgrades the dependency on Blazor from 0.7 to 3.0-preview5; and by doing so, it also upgrades the dependency on .NET Core from 2.1 to 3.0-preview5.
This brings a number of necessary changes to projects. Here are the necessary steps:</p>
<ul>
<li><p>Install <a href="https://dotnet.microsoft.com/download/dotnet-core">.NET Core 3.0-preview5</a>.</p>
</li>
<li><p>If your solution contains a <code>global.json</code> file with an explicit SDK version, either remove the file or update its SDK version to <code>3.0.100-preview5</code>.</p>
</li>
<li><p>In <code>paket.dependencies</code>:</p>
<ul>
<li>In the <code>framework</code> declaration, replace <code>netcoreapp2.1</code> with <code>netcoreapp3.0</code>.</li>
<li>Remove the following <code>nuget</code> lines:
<ul>
<li><code>Microsoft.AspNetCore.App</code> (In ASP.NET Core 3.0, it is automatically included by the SDK)</li>
<li><code>Microsoft.AspNetCore.Razor.Design</code></li>
<li><code>Microsoft.AspNetCore.SignalR</code></li>
</ul>
</li>
<li>Replace <code>clitool Microsoft.AspNetCore.Blazor.Cli</code> with <code>nuget Microsoft.AspNetCore.Blazor.DevServer</code>.</li>
<li>For all the <code>Microsoft.AspNetCore.Blazor*</code> and <code>Bolero*</code> dependencies, remove version constraints if there are any (such as <code>~&gt; 0.7.0</code>), and add <code>prerelease</code> as a version constraint.</li>
</ul>
</li>
<li><p>In <code>src/*.Client/paket.references</code>:</p>
<ul>
<li>Replace <code>Microsoft.AspNetCore.Blazor.Cli</code> with <code>Microsoft.AspNetCore.Blazor.DevServer</code>.</li>
</ul>
</li>
<li><p>In <code>src/*.Server/paket.references</code>:</p>
<ul>
<li>Remove <code>Microsoft.AspNetCore.App</code>.</li>
</ul>
</li>
<li><p>In both <code>*.fsproj</code> files, replace the <code>TargetFramework</code> from <code>netcoreapp2.1</code> to <code>netcoreapp3.0</code>. Also, remove the following lines from <code>*.Client.fsproj</code>:</p>
<pre><code class="language-xml">&lt;RunCommand&gt;dotnet&lt;/RunCommand&gt;
&lt;RunArguments&gt;blazor serve&lt;/RunArguments&gt;
</code></pre>
</li>
</ul>
<p>You can now run <code>.paket/paket update</code> to update the packages.
There are also a few code changes to apply:</p>
<ul>
<li><p>In <code>src/*.Client/Startup.fs</code>:</p>
<ul>
<li>Replace <code>Microsoft.AspNetCore.Blazor.Builder</code> with <code>Microsoft.AspNetCore.Components.Builder</code>.</li>
<li>Replace <code>IBlazorApplicationBuilder</code> with <code>IComponentsApplicationBuilder</code>.</li>
</ul>
</li>
<li><p>In <code>src/*.Server/Startup.fs</code>:</p>
<ul>
<li>Replace <code>IHostingEnvironment</code> with <code>IWebHostEnvironment</code>.</li>
</ul>
</li>
</ul>
<p>Your solution should now build and run successfully.
If your code uses Blazor APIs directly, please check the Blazor <a href="https://devblogs.microsoft.com/aspnet/blazor-0-8-0-experimental-release-now-available/">0.8</a>, <a href="https://devblogs.microsoft.com/aspnet/blazor-0-9-0-experimental-release-now-available/">0.9</a> and <a href="https://devblogs.microsoft.com/aspnet/blazor-now-in-official-preview/">3.0</a> upgrade guides for more code changes you might need to make.</p>
<p>If you are having any issues with this upgrade, don't hesitate to <a href="https://github.com/fsbolero/bolero/issues">post an issue on GitHub!</a></p>
</div></section>
            </div>
            <div class="column is-one-quarter-tablet is-one-fifth-desktop sidebar-column">
              <section class="section">
                <div class="menu">
                  <div class="menu-label">Documentation</div>
                  <ul class="menu-list"><li>
                      <a href="/docs">Getting Started</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/HTML">Writing HTML</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/Templating">HTML templates</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/Elmish">Using Elmish</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/Routing">Routing</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/Remoting">Remoting</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a href="/docs/Blazor">Using Blazor features</a>
                      <ul class="is-hidden"></ul>
                    </li><li>
                      <a class="is-active" href="/docs/Upgrade">Upgrade guide</a>
                      <ul><li>
                          <a href="#from-v07-to-v08">From v0.7 to v0.8</a>
                        </li><li>
                          <a href="#from-v06-to-v07">From v0.6 to v0.7</a>
                        </li><li>
                          <a href="#from-v05-to-v06">From v0.5 to v0.6</a>
                        </li><li>
                          <a href="#from-v04-to-v05">From v0.4 to v0.5</a>
                        </li></ul>
                    </li></ul>
                </div>
              </section>
            </div>
          </div>
        </div>
      </section>
    
  <footer class="section footer first-footer has-text-centered">
    <div class="container">
      <div class="columns">
        <div class="column">
          <a target="_blank" href="https://github.com/fsbolero/template">
            <img class="box no-padding" data-src="/img/screenshot-template.png" />
            <h1 class="title">Bolero project template</h1>
          </a>
        </div>
        <div class="column">
          <a target="_blank" href="https://fsbolero.github.io/TodoMVC">
            <img class="box no-padding" data-src="/img/screenshot-todomvc.png" />
            <h1 class="title">TodoMVC</h1>
          </a>
        </div>
        <div class="column">
          <a target="_blank" href="https://tryfsharp.fsbolero.io">
            <img class="box no-padding" data-src="/img/screenshot-tryfsharp.png" />
            <h1 class="title">Try F# in your browser</h1>
          </a>
        </div>
      </div>
    </div>
  </footer>
  <footer class="section footer second-footer">
    <div class="container">
      <div class="columns">
        <div class="column">
          <h1 class="title"><a href="/">Home</a></h1>
          <h1 class="title">Made with Bolero</h1>
          <div class="menu">
            <ul class="menu-list">
              <li><a target="_blank" href="https://tryfsharp.fsbolero.io">Try F#</a></li>
              <li><a target="_blank" href="https://github.com/fsbolero/TodoMVC">TodoMVC</a></li>
            </ul>
          </div>
        </div>
        <div class="column">
          <h1 class="title">Documentation</h1>
          <div class="menu">
            <ul class="menu-list"><li><a href="/docs">Getting Started</a></li><li><a href="/docs/HTML">Writing HTML</a></li><li><a href="/docs/Templating">HTML templates</a></li><li><a href="/docs/Elmish">Using Elmish</a></li><li><a href="/docs/Routing">Routing</a></li><li><a href="/docs/Remoting">Remoting</a></li><li><a href="/docs/Blazor">Using Blazor features</a></li><li><a href="/docs/Upgrade">Upgrade guide</a></li></ul>
          </div>
        </div>
        <div class="column">
          <h1 class="title">We leverage</h1>
          <div class="menu">
            <ul class="menu-list">
              <li><a target="_blank" href="https://fsharp.org">F#</a></li>
              <li><a target="_blank" href="https://elmish.github.io/elmish/">Elmish</a></li>
              <li><a target="_blank" href="https://dot.net">.NET Core</a></li>
              <li><a target="_blank" href="https://blazor.net">Blazor</a></li>
              <li><a target="_blank" href="https://webassembly.org/">WebAssembly</a></li>
            </ul>
          </div>
        </div>
        <div class="column">
          <h1 class="title">Find us</h1>
          <ul>
            <li>
              <a class="github-button" href="https://github.com/fsbolero/bolero" data-size="large" aria-label="Star fsbolero/bolero on GitHub">Bolero on GitHub</a>
            </li>
            <li>
              <a href="https://twitter.com/fsbolero?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-dnt="true" data-show-count="false">Follow @fsbolero</a>
            </li>
            <li>
              <a target="_blank" href="https://nuget.org/packages/Bolero"><img alt="NuGet" src="https://img.shields.io/nuget/v/Bolero.svg?label=Bolero%20on%20NuGet&amp;logo=nuget&amp;style=for-the-badge" /></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/8.6.0/lazyload.min.js"></script>
  <script type="text/javascript">new LazyLoad();</script>
  <script src="/js/Client.min.js"></script>
  <script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
  <script async="" defer="" src="https://platform.twitter.com/widgets.js"></script>
  
  
</body>
</html>